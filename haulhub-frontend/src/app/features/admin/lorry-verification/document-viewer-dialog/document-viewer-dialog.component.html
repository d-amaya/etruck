<h2 mat-dialog-title>Verification Documents - {{ data.lorry.lorryId }}</h2>

<mat-dialog-content>
  <div class="document-viewer-container">
    <!-- Document List -->
    <div class="document-list">
      <h3>Documents ({{ data.lorry.verificationDocuments.length }})</h3>
      <mat-list>
        <mat-list-item
          *ngFor="let doc of data.lorry.verificationDocuments"
          [class.selected]="selectedDocument?.documentId === doc.documentId"
          (click)="selectDocument(doc)"
        >
          <mat-icon matListItemIcon>description</mat-icon>
          <div matListItemTitle>{{ doc.fileName }}</div>
          <div matListItemLine>
            {{ formatFileSize(doc.fileSize) }} â€¢ {{ formatDate(doc.uploadedAt) }}
          </div>
        </mat-list-item>
      </mat-list>

      <div *ngIf="data.lorry.verificationDocuments.length === 0" class="no-documents">
        <mat-icon>info</mat-icon>
        <p>No documents uploaded</p>
      </div>
    </div>

    <!-- Document Viewer -->
    <div class="document-viewer">
      <div *ngIf="!selectedDocument" class="no-selection">
        <mat-icon>description</mat-icon>
        <p>Select a document to view</p>
      </div>

      <div *ngIf="loading" class="loading-container">
        <mat-spinner></mat-spinner>
        <p>Loading document...</p>
      </div>

      <div *ngIf="error && !loading" class="error-container">
        <mat-icon color="warn">error</mat-icon>
        <p>{{ error }}</p>
        <button mat-raised-button color="primary" (click)="selectDocument(selectedDocument!)">
          <mat-icon>refresh</mat-icon>
          Retry
        </button>
      </div>

      <div *ngIf="selectedDocument && documentUrl && !loading && !error" class="document-content">
        <div class="document-header">
          <h4>{{ selectedDocument.fileName }}</h4>
          <button mat-icon-button (click)="openInNewTab()" matTooltip="Open in new tab">
            <mat-icon>open_in_new</mat-icon>
          </button>
        </div>

        <!-- Image viewer -->
        <div *ngIf="isImageFile(selectedDocument.contentType)" class="image-viewer">
          <img [src]="documentUrl" [alt]="selectedDocument.fileName" />
        </div>

        <!-- PDF viewer -->
        <div *ngIf="isPdfFile(selectedDocument.contentType)" class="pdf-viewer">
          <iframe [src]="documentUrl" frameborder="0"></iframe>
        </div>

        <!-- Other file types -->
        <div *ngIf="!isImageFile(selectedDocument.contentType) && !isPdfFile(selectedDocument.contentType)" class="unsupported-viewer">
          <mat-icon>description</mat-icon>
          <p>Preview not available for this file type</p>
          <button mat-raised-button color="primary" (click)="openInNewTab()">
            <mat-icon>download</mat-icon>
            Download File
          </button>
        </div>
      </div>
    </div>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onClose()">Close</button>
</mat-dialog-actions>
