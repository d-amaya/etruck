<mat-card>
  <mat-card-header>
    <mat-card-title>
      <div class="header-container">
        <h2>Register New Truck</h2>
      </div>
    </mat-card-title>
  </mat-card-header>

  <mat-card-content>
    <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()">
      <!-- Basic Information Section -->
      <div class="form-section">
        <h3>Basic Information</h3>
        <mat-divider></mat-divider>

        <div class="form-row">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Truck Name</mat-label>
            <input matInput formControlName="name" placeholder="e.g., Freigh101">
            <mat-icon matPrefix>local_shipping</mat-icon>
            <mat-error *ngIf="registrationForm.get('name')?.hasError('required')">
              Truck name is required
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline" class="half-width">
            <mat-label>Brand</mat-label>
            <input matInput formControlName="brand" placeholder="e.g., Freightliner">
            <mat-error *ngIf="registrationForm.get('brand')?.hasError('required')">
              Brand is required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="half-width">
            <mat-label>Year</mat-label>
            <input matInput type="number" formControlName="year" placeholder="e.g., 2020">
            <mat-error *ngIf="registrationForm.get('year')?.hasError('required')">
              Year is required
            </mat-error>
            <mat-error *ngIf="registrationForm.get('year')?.hasError('min') || registrationForm.get('year')?.hasError('max')">
              Invalid year
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline" class="half-width">
            <mat-label>Color</mat-label>
            <input matInput formControlName="color" placeholder="e.g., White">
            <mat-error *ngIf="registrationForm.get('color')?.hasError('required')">
              Color is required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="half-width">
            <mat-label>License Plate</mat-label>
            <input matInput formControlName="licensePlate" placeholder="e.g., F0077X">
            <mat-error *ngIf="registrationForm.get('licensePlate')?.hasError('required')">
              License plate is required
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>VIN (Vehicle Identification Number)</mat-label>
            <input matInput formControlName="vin" placeholder="17-character VIN" maxlength="17">
            <mat-icon matPrefix>fingerprint</mat-icon>
            <mat-error *ngIf="registrationForm.get('vin')?.hasError('required')">
              VIN is required
            </mat-error>
            <mat-error *ngIf="registrationForm.get('vin')?.hasError('pattern')">
              VIN must be exactly 17 characters (letters and numbers, excluding I, O, Q)
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <!-- Status Section -->
      <div class="form-section">
        <h3>Status</h3>
        <mat-divider></mat-divider>

        <div class="form-row">
          <mat-slide-toggle formControlName="isActive">
            Active (Available for order assignments)
          </mat-slide-toggle>
        </div>
      </div>

      <!-- Verification Documents Section -->
      <div class="form-section">
        <h3>Verification Documents</h3>
        <mat-divider></mat-divider>

        <p class="section-description">
          Upload documents to verify truck ownership (registration, title, insurance, etc.)
        </p>

        <div class="file-upload-container">
          <input
            type="file"
            #fileInput
            (change)="onFileSelected($event)"
            multiple
            accept=".pdf,.jpg,.jpeg,.png,.doc,.docx"
            style="display: none">
          
          <button mat-raised-button type="button" (click)="fileInput.click()">
            <mat-icon>upload_file</mat-icon>
            Upload Documents
          </button>

          <div class="selected-files" *ngIf="selectedFiles.length > 0">
            <h4>Selected Files:</h4>
            <div class="file-item" *ngFor="let file of selectedFiles; let i = index">
              <mat-icon>description</mat-icon>
              <span class="file-name">{{ file.name }}</span>
              <button mat-icon-button type="button" (click)="removeFile(i)" matTooltip="Remove file">
                <mat-icon>close</mat-icon>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Notes Section -->
      <div class="form-section">
        <h3>Additional Notes</h3>
        <mat-divider></mat-divider>

        <div class="form-row">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Notes</mat-label>
            <textarea matInput formControlName="notes" rows="4" placeholder="Any additional information about this truck"></textarea>
          </mat-form-field>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="form-actions">
        <button mat-button type="button" (click)="onCancel()" [disabled]="saving">
          Cancel
        </button>
        <button mat-raised-button color="primary" type="submit" [disabled]="saving">
          <mat-spinner *ngIf="saving" diameter="20"></mat-spinner>
          <span *ngIf="!saving">Register Truck</span>
        </button>
      </div>
    </form>
  </mat-card-content>
</mat-card>
